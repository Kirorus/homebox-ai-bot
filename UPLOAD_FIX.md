# Исправление проблемы загрузки фотографий

## Проблема
Ошибка `"failed to parse multipart form"` при загрузке фотографий в HomeBox API.

**НАЙДЕНА ПРИЧИНА:** API HomeBox требует обязательное поле `name` в multipart форме!

## Решение
Добавлены **5 альтернативных методов** загрузки фотографий:

### 1. Стандартный multipart/form-data
- Полный контроль над MIME-типами
- Автоматическое определение типа файла
- Подробное логирование

### 2. Упрощенный multipart/form-data
- Минимальный набор полей
- Без дополнительных заголовков

### 3. Base64 JSON
- Загрузка через JSON payload
- Кодирование файла в base64

### 4. Curl-style multipart
- Формирование запроса в стиле curl
- Минимальные заголовки

### 5. Raw HTTP multipart
- Ручное формирование multipart запроса
- Полный контроль над boundary и заголовками

## Новые возможности

### Административные команды:
- `/testupload` - тестирование всех методов загрузки
- `/checkapi` - проверка возможностей API HomeBox
- `/quicktest` - быстрый тест Raw HTTP метода
- Улучшенное логирование для диагностики

### ✅ ИСПРАВЛЕНИЕ НАЙДЕНО:
Все методы теперь включают **обязательное поле `name`** в multipart форме!

### Автоматическое переключение методов:
Бот автоматически пробует все **5 методов** в порядке приоритета:
1. Стандартный multipart
2. Альтернативный multipart  
3. Base64 JSON
4. Curl-style multipart
5. Raw HTTP multipart

### Детальное логирование:
- Уровень DEBUG для диагностики
- Логирование всех HTTP запросов
- Подробные сообщения об ошибках

## Использование

### Для пользователей:
Никаких изменений в использовании - все работает автоматически.

### Для администраторов:
```
/testupload - тестирование методов загрузки
/stats - статистика бота
/cleanup - очистка временных файлов
```

## Диагностика

### Логи:
- `bot.log` - основной лог бота
- `errors.log` - детальные ошибки в JSON формате

### Проверка API:
Бот автоматически проверяет возможности API и выбирает подходящий метод загрузки.

## Технические детали

### Файлы изменены:
- `homebox_api.py` - добавлены новые методы загрузки
- `bot.py` - добавлена команда тестирования
- `i18n.py` - новые сообщения

### Новые методы:
- `upload_photo()` - стандартная загрузка
- `upload_photo_alternative()` - альтернативная загрузка
- `upload_photo_base64()` - загрузка через base64
- `upload_photo_curl_style()` - загрузка в стиле curl
- `upload_photo_raw_http()` - ручная загрузка через HTTP
- `upload_photo_different_fields()` - тестирование разных имен полей
- `test_upload_methods()` - тестирование всех методов
- `check_api_capabilities()` - проверка возможностей API
- `try_different_endpoints()` - тестирование разных endpoints
