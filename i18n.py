from typing import Dict


LANG_RU = 'ru'
LANG_EN = 'en'


MESSAGES: Dict[str, Dict[str, str]] = {
    LANG_RU: {
        'start.intro': (
            "üëã –ü—Ä–∏–≤–µ—Ç! –Ø –ø–æ–º–æ–≥—É –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã –≤ —Ç–≤–æ–π Homebox.\n\n"
            "üì∏ –ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å –º–Ω–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –ø—Ä–µ–¥–º–µ—Ç–∞, –∏ —è:\n"
            "‚Ä¢ –û–ø—Ä–µ–¥–µ–ª—é —á—Ç–æ —ç—Ç–æ\n"
            "‚Ä¢ –°–æ–∑–¥–∞–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ\n"
            "‚Ä¢ –ü—Ä–µ–¥–ª–æ–∂—É –ø–æ–¥—Ö–æ–¥—è—â–∏–π —è—â–∏–∫\n"
            "‚Ä¢ –ü–æ–∑–≤–æ–ª—é –≤—Å—ë –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å\n"
            "‚Ä¢ –î–æ–±–∞–≤–ª—é –≤ Homebox\n\n"
            "üí° **–°–æ–≤–µ—Ç:** –ú–æ–∂–µ—à—å –¥–æ–±–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∫ —Ñ–æ—Ç–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, \"—Å—Ç–∞—Ä–∞—è –∫–Ω–∏–≥–∞\", \"–∫—Ä–∞—Å–Ω–∞—è –∫—Ä—É–∂–∫–∞\") - —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –º–Ω–µ —Ç–æ—á–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç!\n\n"
            "–û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å!"
        ),
        'access.denied': '‚õîÔ∏è –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.',
        'settings.title': '‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞',
        'settings.bot_lang.title': 'üåê –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –±–æ—Ç–∞:',
        'settings.gen_lang.title': 'ü§ñ –Ø–∑—ã–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞–∑–≤–∞–Ω–∏–π –∏ –æ–ø–∏—Å–∞–Ω–∏–π:',
        'settings.choose_model': '–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å LLM:',
        'settings.lang.ru': 'üá∑üá∫ –†—É—Å—Å–∫–∏–π',
        'settings.lang.en': 'üá¨üáß English',
        'settings.bot_lang.set.ru': '–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: –†—É—Å—Å–∫–∏–π',
        'settings.bot_lang.set.en': 'Interface language set: English',
        'settings.gen_lang.set.ru': '–Ø–∑—ã–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: –†—É—Å—Å–∫–∏–π',
        'settings.gen_lang.set.en': 'Generation language set: English',
        'settings.model.unavailable': '–ú–æ–¥–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞',
        'analyze.progress': 'üîç –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ...',
        'homebox.locations.fail': '‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —è—â–∏–∫–æ–≤ –∏–∑ Homebox',
        'cmd.myid': '–í–∞—à Telegram ID: {user_id}',
        'result.title': 'üìã **–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è:**\n\n',
        'field.name': '**–ù–∞–∑–≤–∞–Ω–∏–µ:** {value}',
        'field.description': '**–û–ø–∏—Å–∞–Ω–∏–µ:** {value}',
        'field.location': '**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π —è—â–∏–∫:** {value}',
        'edit.what_change': '–ß—Ç–æ —Ö–æ—á–µ—à—å –∏–∑–º–µ–Ω–∏—Ç—å?',
        'btn.edit.name': '‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ',
        'btn.edit.description': 'üìù –ò–∑–º–µ–Ω–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ',
        'btn.edit.location': 'üì¶ –ò–∑–º–µ–Ω–∏—Ç—å —è—â–∏–∫',
        'btn.confirm': '‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏ –¥–æ–±–∞–≤–∏—Ç—å',
        'btn.cancel': '‚ùå –û—Ç–º–µ–Ω–∏—Ç—å',
        'edit.enter_name': '‚úèÔ∏è –í–≤–µ–¥–∏ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:',
        'edit.enter_description': 'üìù –í–≤–µ–¥–∏ –Ω–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:',
        'edit.select_location': 'üì¶ –í—ã–±–µ—Ä–∏ —è—â–∏–∫:',
        'changed.name': '‚úÖ –ù–∞–∑–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–æ!',
        'changed.description': '‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–æ!',
        'changed.location': '‚úÖ –Ø—â–∏–∫ –∏–∑–º–µ–Ω–µ–Ω!',
        'back': '¬´ –ù–∞–∑–∞–¥',
        'confirm.adding': '‚è≥ –î–æ–±–∞–≤–ª—è—é –ø—Ä–µ–¥–º–µ—Ç –≤ Homebox...',
        'added.success': '‚úÖ **–ü—Ä–µ–¥–º–µ—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!**',
        'added.new_prompt': '–û—Ç–ø—Ä–∞–≤—å –Ω–æ–≤–æ–µ —Ñ–æ—Ç–æ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –µ—â–µ –æ–¥–∏–Ω –ø—Ä–µ–¥–º–µ—Ç.',
        'added.photo_failed': '‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ.',
        'added.fail': '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–µ–¥–º–µ—Ç–∞ –≤ Homebox. –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑.',
        'cancel.done': '‚ùå –û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞. –û—Ç–ø—Ä–∞–≤—å –Ω–æ–≤–æ–µ —Ñ–æ—Ç–æ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ.',
        'caption.used': 'üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ç–æ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è',
        'caption.not_used': 'üì∑ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é',
        'admin.stats.title': 'üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–æ—Ç–∞**',
        'admin.stats.users': 'üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {count}',
        'admin.stats.items': 'üì¶ –ü—Ä–µ–¥–º–µ—Ç–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {count}',
        'admin.stats.sessions': 'üîÑ –ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π: {count}',
        'admin.stats.uptime': '‚è± –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: {uptime}',
        'admin.cleanup.done': 'üßπ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –£–¥–∞–ª–µ–Ω–æ {files} –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.',
        'admin.cleanup.error': '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ: {error}',
        'admin.access.denied': '‚õîÔ∏è –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É –∫–æ–º–∞–Ω–¥—É.',
        'admin.test_upload': 'üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π...',
        'admin.test_upload.results': 'üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏:\n\n{results}',
        'admin.check_api': 'üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π API HomeBox...',
        'admin.check_api.results': 'üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ API:\n\n{results}',
        'admin.quick_test': '‚ö° –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏...',
        'admin.quick_test.success': '‚úÖ –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ!',
        'admin.quick_test.failed': '‚ùå –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –Ω–µ –ø—Ä–æ—à–µ–ª: {error}',
        'progress.downloading': '‚¨áÔ∏è –°–∫–∞—á–∏–≤–∞—é —Ñ–æ—Ç–æ...',
        'progress.validating': 'üîç –ü—Ä–æ–≤–µ—Ä—è—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ...',
        'progress.getting_locations': 'üì¶ –ü–æ–ª—É—á–∞—é —Å–ø–∏—Å–æ–∫ —è—â–∏–∫–æ–≤...',
        'progress.analyzing': 'ü§ñ –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Å –ø–æ–º–æ—â—å—é –ò–ò...',
        'progress.uploading': '‚¨ÜÔ∏è –ó–∞–≥—Ä—É–∂–∞—é –≤ HomeBox...',
        'error.invalid_image': '‚ùå –û—à–∏–±–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º: {error}',
        'error.try_again': '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –¥—Ä—É–≥–æ–µ —Ñ–æ—Ç–æ (JPEG, PNG –∏–ª–∏ WEBP, –¥–æ 20MB).',
        'btn.prev': '¬´ –ù–∞–∑–∞–¥',
        'btn.next': '–í–ø–µ—Ä–µ–¥ ¬ª',
        'model.selected': '–ú–æ–¥–µ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: {model}',
    },
    LANG_EN: {
        'start.intro': (
            "üëã Hi! I can help add items to your Homebox.\n\n"
            "üì∏ Just send me a photo and I will:\n"
            "‚Ä¢ Recognize the item\n"
            "‚Ä¢ Propose a name and description\n"
            "‚Ä¢ Suggest the best box\n"
            "‚Ä¢ Let you edit details\n"
            "‚Ä¢ Add it to Homebox\n\n"
            "üí° **Tip:** You can add a description to the photo (e.g., \"old book\", \"red mug\") - this will help me identify the item more accurately!\n\n"
            "Send a photo to start!"
        ),
        'access.denied': '‚õîÔ∏è Access denied. Contact administrator.',
        'settings.title': '‚öôÔ∏è Bot settings',
        'settings.bot_lang.title': 'üåê Bot interface language:',
        'settings.gen_lang.title': 'ü§ñ Item generation language:',
        'settings.choose_model': 'Choose LLM model:',
        'settings.lang.ru': 'üá∑üá∫ Russian',
        'settings.lang.en': 'üá¨üáß English',
        'settings.bot_lang.set.ru': 'Interface language set: Russian',
        'settings.bot_lang.set.en': 'Interface language set: English',
        'settings.gen_lang.set.ru': 'Generation language set: Russian',
        'settings.gen_lang.set.en': 'Generation language set: English',
        'settings.model.unavailable': 'Model is not available',
        'analyze.progress': 'üîç Analyzing image...',
        'homebox.locations.fail': '‚ùå Failed to fetch Homebox locations',
        'cmd.myid': 'Your Telegram ID: {user_id}',
        'result.title': 'üìã **Recognition result:**\n\n',
        'field.name': '**Name:** {value}',
        'field.description': '**Description:** {value}',
        'field.location': '**Suggested box:** {value}',
        'edit.what_change': 'What would you like to change?',
        'btn.edit.name': '‚úèÔ∏è Edit name',
        'btn.edit.description': 'üìù Edit description',
        'btn.edit.location': 'üì¶ Change box',
        'btn.confirm': '‚úÖ Confirm and add',
        'btn.cancel': '‚ùå Cancel',
        'edit.enter_name': '‚úèÔ∏è Enter a new name:',
        'edit.enter_description': 'üìù Enter a new description:',
        'edit.select_location': 'üì¶ Choose a box:',
        'changed.name': '‚úÖ Name updated!',
        'changed.description': '‚úÖ Description updated!',
        'changed.location': '‚úÖ Box updated!',
        'back': '¬´ Back',
        'confirm.adding': '‚è≥ Adding item to Homebox...',
        'added.success': '‚úÖ **Item added successfully!**',
        'added.new_prompt': 'Send a new photo to add another item.',
        'added.photo_failed': '‚ö†Ô∏è Failed to upload photo.',
        'added.fail': '‚ùå Failed to add item to Homebox. Try again.',
        'cancel.done': '‚ùå Operation canceled. Send a new photo to restart.',
        'caption.used': 'üìù Used photo description to improve recognition',
        'caption.not_used': 'üì∑ Recognition based on image only',
        'admin.stats.title': 'üìä **Bot Statistics**',
        'admin.stats.users': 'üë• Users: {count}',
        'admin.stats.items': 'üì¶ Items processed: {count}',
        'admin.stats.sessions': 'üîÑ Active sessions: {count}',
        'admin.stats.uptime': '‚è± Uptime: {uptime}',
        'admin.cleanup.done': 'üßπ Cleanup completed. Removed {files} temporary files.',
        'admin.cleanup.error': '‚ùå Cleanup error: {error}',
        'admin.access.denied': '‚õîÔ∏è Only administrators can use this command.',
        'admin.test_upload': 'üß™ Testing photo upload methods...',
        'admin.test_upload.results': 'üìä Upload test results:\n\n{results}',
        'admin.check_api': 'üîç Checking HomeBox API capabilities...',
        'admin.check_api.results': 'üìã API check results:\n\n{results}',
        'admin.quick_test': '‚ö° Quick upload test...',
        'admin.quick_test.success': '‚úÖ Quick test passed!',
        'admin.quick_test.failed': '‚ùå Quick test failed: {error}',
        'progress.downloading': '‚¨áÔ∏è Downloading photo...',
        'progress.validating': 'üîç Validating image...',
        'progress.getting_locations': 'üì¶ Getting locations...',
        'progress.analyzing': 'ü§ñ Analyzing with AI...',
        'progress.uploading': '‚¨ÜÔ∏è Uploading to HomeBox...',
        'error.invalid_image': '‚ùå Image error: {error}',
        'error.try_again': 'Please send another photo (JPEG, PNG or WEBP, up to 20MB).',
        'btn.prev': '¬´ Prev',
        'btn.next': 'Next ¬ª',
        'model.selected': 'Model set: {model}',
    },
}


def t(lang: str, key: str, **kwargs) -> str:
    locale = MESSAGES.get(lang) or MESSAGES[LANG_RU]
    template = locale.get(key) or MESSAGES[LANG_RU].get(key, key)
    try:
        return template.format(**kwargs)
    except Exception:
        return template


